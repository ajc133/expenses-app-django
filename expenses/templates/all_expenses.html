{% extends "master.html" %}

{% block title %}
List of all expenses
{% endblock %}

{% block content %}
<div class="mycard">
	<form method="post">{% csrf_token %}
		<fieldset>
			<legend>Enter expense</legend>
			<p>
				<label for="item">Item</label>
				<input type="text" id="item" name="item" required />
			</p>
			<p>
				<label for="cost">Cost</label>
				<input type="number" id="cost" name="cost" step="0.01" required />
			</p>
			<p>
				<label for="description">Description</label>
				<input type="text" id="description" name="description" />
			</p>
			<p>
				<label for="user-name-select">Who paid?</label>
				<select id="user-name-select" name="user-id" autocomplete="off" required />
				{% for user in users %}
				<option value={{ user.id }}>{{ user.first_name }}</option>
				{% endfor %}
				</select>
			</p>
			<p>
				<button type="submit">Add Expense</button>
			</p>
		</fieldset>
	</form>
</div>
<div>
	<ul>
		{% for u in users %}
		{% if u.owes > 0 %} <li>{{ u.first_name }} owes ${{ u.owes|floatformat:"-2" }}</li> {% endif %}
		{# Editor thinks 'less than' sign is a tag start. Hence weird line 45 tab #}
		{% if u.owes < 0 %} <li>{{ u.first_name }} is owed ${% widthratio -1 1 u.owes %}</li> {% endif %}
			{% endfor %}
	</ul>
</div>
<div class="mycard">
	<table>
		<tbody>
			{% for x in expenses %}
			<tr>
				<td class="created-cell">{{ x.created_at|date:"M" }}<br>{{ x.created_at|date:"j" }}</td>
				<td class="item-cell"><a href="{% url 'expense_details' x.id %}">{{ x.item }}</a></td>
				<td class="payer-cell">{{ x.payer.first_name }}</td>
				<td class="cost-cell">${{ x.cost|floatformat:"-2" }}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endblock %}
